---
teams:
- name: WhiteTeam
  color: White
  users:
  - username: whiteteamuser
    password: testpass
- name: RedTeam
  color: Red
  users:
  - username: redteamuser
    password: testpass
- name: Team0
  color: Blue
  users:
  - username: team0user1
    password: testpass0
  services:
  - name: AD - Alexander
    check_name: LDAPCheck
    host: 10.2.0.1
    port: 389
    points: 50
    accounts:
    - username: martha
      password: "rockyou.txt-SUCKS!"
    - username: jeff
      password: "rockyou.txt-SUCKS!"
    environments:
    - matching_content: "^result: 0 Success"
      properties:
      - name: domain
        value: "team0.ists.io"
      - name: base_dn
        value: "dc=team0,dc=ists,dc=io"
  - name: DNS - Alexander
    check_name: DNSCheck
    host: 10.2.0.1
    port: 53
    points: 100
    environments:
    - matching_content: 'status: NOERROR'
      properties:
      - name: qtype
        value: A
      - name: domain
        value: attila.team0.ists.io
    - matching_content: 'status: NOERROR'
      properties:
      - name: qtype
        value: A
      - name: domain
        value: leonidas.team0.ists.io
    - matching_content: 'status: NOERROR'
      properties:
      - name: qtype
        value: A
      - name: domain
        value: bismark.team0.ists.io
    - matching_content: 'status: NOERROR'
      properties:
      - name: qtype
        value: NS
      - name: domain
        value: "team0.ists.io"
  - name: WinRM - Alexander
    check_name: winrmCheck
    host: 10.2.0.1
    port: 5985
    points: 150
    accounts:
    - username: martha
      password: "rockyou.txt-SUCKS!"
    - username: jeff
      password: "rockyou.txt-SUCKS!"
    environments:
    - matching_content: "Spaceminersareprettylame"
      properties:
      - name: commands
        value: echo Spaceminersareprettylame
  - name: SMB - Julius
    check_name: SMBCheck
    host: 10.2.0.2
    port: 445
    points: 100
    accounts:
    - username: jeff
      password: "rockyou.txt-SUCKS!"
    - username: martha
      password: "rockyou.txt-SUCKS!"
    environments:
    - matching_content: "^SUCCESS"
      properties:
      - name: remote_name
        value: Julius
      - name: share
        value: meme_share
      - name: file
        value: flag.txt
      # SHA256 hash of file
      - name: hash
        value: 3ac8347c1130bd1ffe9078f99be6cb690baedd9e5552de0f7140c0daded7e1fa
  - name: FTP - Julius
    check_name: FTPCheck
    host: 10.2.0.2
    port: 21
    points: 150
    accounts:
    - username: jeff
      password: "rockyou.txt-SUCKS!"
    - username: martha
      password: "rockyou.txt-SUCKS!"
    environments:
    - matching_content: "^SUCCESS"
      properties:
      - name: remotefilepath
        value: "means_of_production.txt"
      - name: filecontents
        value: "seize me"
  - name: WinRM - Julius
    check_name: winrmCheck
    host: 10.2.0.2
    port: 5985
    points: 150
    accounts:
    - username: martha
      password: "rockyou.txt-SUCKS!"
    - username: jeff
      password: "rockyou.txt-SUCKS!"
    environments:
    - matching_content: "Spaceminersareprettylame"
      properties:
      - name: commands
        value: echo Spaceminersareprettylame
  - name: Docker API - Churchhill
    check_name: DockerAPICheck
    host: 10.2.0.3
    port: 2375
    points: 100
    environments:
    - matching_content: SUCCESS
      properties:
      - name: docker_image
        value: 'hello-world:latest'
  - name: SSH - Churchhill
    check_name: SSHCheck
    host: 10.2.0.3
    port: 22
    points: 150
    accounts:
    - username: jeff
      password: "rockyou.txt-SUCKS!"
    - username: martha
      password: "rockyou.txt-SUCKS!"
    environments:
    - matching_content: "^SUCCESS"
      properties:
      - name: commands
        value: id;ls -l /home
    - matching_content: PID
      properties:
      - name: commands
        value: ps
  - name: HTTP - Leonidas
    check_name: HTTPCheck
    host: 10.2.0.4
    port: 80
    points: 100
    environments:
    # TODO: Whats the string we are looking for here?
    - matching_content: Just link your credit card, specify the amount, and our country will be better because of
      properties:
      - name: useragent
        value: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)
      - name: vhost
        value: 10.2.0.4
      - name: uri
        value: "/"
    - matching_content: Just link your credit card, specify the amount, and our country will be better because of
      properties:
      - name: useragent
        value: Opera/9.80 (Windows NT 6.2; Win64; x64) Presto/2.12 Version/12.16
      - name: vhost
        value: 10.2.0.4
      - name: uri
        value: "/"
  - name: Elasticsearch - Leonidas
    check_name: ElasticsearchCheck
    host: 10.2.0.4
    port: 9200
    points: 100
    environments:
    - matching_content: "^SUCCESS"
      properties:
      - name: index
        value: messages
      - name: doc_type
        value: ists_rocks
  - name: SSH - Leonidas
    check_name: SSHCheck
    host: 10.2.0.4
    port: 22
    points: 150
    accounts:
    - username: jeff
      password: "rockyou.txt-SUCKS!"
    - username: martha
      password: "rockyou.txt-SUCKS!"
    environments:
    - matching_content: "^SUCCESS"
      properties:
      - name: commands
        value: id;ls -l /home
    - matching_content: PID
      properties:
      - name: commands
        value: ps
  - name: HTTP - Attila
    check_name: HTTPCheck
    host: 10.2.0.5
    port: 80
    points: 100
    environments:
    - matching_content: Just link your credit card, specify the amount, and our country will be better because of
      properties:
      - name: useragent
        value: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)
      - name: vhost
        value: 10.2.0.5
      - name: uri
        value: "/"
    - matching_content: Just link your credit card, specify the amount, and our country will be better because of
      properties:
      - name: useragent
        value: Opera/9.80 (Windows NT 6.2; Win64; x64) Presto/2.12 Version/12.16
      - name: vhost
        value: 10.2.0.5
      - name: uri
        value: "/"
  - name: SSH - Attila
    check_name: SSHCheck
    host: 10.2.0.5
    port: 22
    points: 150
    accounts:
    - username: jeff
      password: "rockyou.txt-SUCKS!"
    - username: martha
      password: "rockyou.txt-SUCKS!"
    environments:
    - matching_content: "^SUCCESS"
      properties:
      - name: commands
        value: id;ls -l /home
    - matching_content: PID
      properties:
      - name: commands
        value: ps
  - name: SMTP - Xerxes
    check_name: SMTPCheck
    host: 10.2.0.6
    port: 25
    points: 100
    accounts:
    - username: jeff@mail.team0.ists.io
      password: "rockyou.txt-SUCKS!"
    environments:
    - matching_content: Successfully sent email
      properties:
      # TODO: This domain might not be correct. I cant find where the ansible is installing it
      # but whiteteam said to use this for mail
      - name: touser
        value: jeff@mail.team0.ists.io
      - name: subject
        value: "Edgar Poe! Open up. This is the secret police"
      - name: body
        value: "What the jellyfish did you just jellyfishing say about me, you little brick?"
  - name: WinRM - Xerxes
    check_name: winrmCheck
    host: 10.2.0.6
    port: 5985
    points: 150
    accounts:
    - username: martha
      password: "rockyou.txt-SUCKS!"
    - username: jeff
      password: "rockyou.txt-SUCKS!"
    environments:
    - matching_content: "Spaceminersareprettylame"
      properties:
      - name: commands
        value: echo Spaceminersareprettylame
  - name: OpenVPN - Ashoka
    check_name: OpenVPNCheck
    host: 10.2.0.7
    port: 1194
    points: 100
    accounts:
    - username: jeff
      password: "rockyou.txt-SUCKS!"
    - username: martha
      password: "rockyou.txt-SUCKS!"
    environments:
    - matching_content: "^SUCCESS"
      properties: 
      - name: ca
        # I'm so sorry, openvpn needs the ca cert for login via the client
        # TODO: We need to pull this and replace it for every teams machine :(
        value: MIIDSzCCAjOgAwIBAgIUNf7YivHK0rWciIy1HsNNx/tGDt4wDQYJKoZIhvcNAQ
  - name: "SSH - Ashoka"
    check_name: SSHCheck
    host: 10.2.0.7
    port: 22
    points: 150
    accounts:
    - username: jeff
      password: "rockyou.txt-SUCKS!"
    - username: martha
      password: "rockyou.txt-SUCKS!"
    environments:
    - matching_content: "^SUCCESS"
      properties:
      - name: commands
        value: "id;ls -l /home"
    - matching_content: PID
      properties:
      - name: commands
        value: ps
  - name: DNS - Gandhi
    check_name: DNSCheck
    host: 10.3.0.1
    port: 53
    points: 100
    environments:
    - matching_content: 'status: NOERROR'
      properties:
      - name: qtype
        value: A
      - name: domain
        value: gandhi.team0.cybertigers.club
    - matching_content: 'status: NOERROR'
      properties:
      - name: qtype
        value: A
      - name: domain
        value: bonaparte.team0.cybertigers.club
    - matching_content: 'status: NOERROR'
      properties:
      - name: qtype
        value: A
      - name: domain
        value: ataturk.team0.cybertigers.club
    - matching_content: 'status: NOERROR'
      properties:
      - name: qtype
        value: NS
      - name: domain
        value: washington.team0.cybertigers.club
  - name: HTTP - Gandhi
    check_name: HTTPCheck
    host: 10.3.0.1
    port: 80
    points: 100
    environments:
    - matching_content: webmin
      properties:
      - name: useragent
        value: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)
      - name: vhost
        value: 10.3.0.1
      - name: uri
        value: "/"
    - matching_content: webmin
      properties:
      - name: useragent
        value: Opera/9.80 (Windows NT 6.2; Win64; x64) Presto/2.12 Version/12.16
      - name: vhost
        value: 10.3.0.1
      - name: uri
        value: "/"
  - name: SSH - Gandhi
    check_name: SSHCheck
    host: 10.3.0.1
    port: 22
    points: 150
    accounts:
    - username: jeff
      password: "rockyou.txt-SUCKS!"
    - username: martha
      password: "rockyou.txt-SUCKS!"
    environments:
    - matching_content: "^SUCCESS"
      properties:
      - name: commands
        value: id;ls -l /home
    - matching_content: PID
      properties:
      - name: commands
        value: ps

  - name: HTTP - Bonaparte
    check_name: HTTPCheck
    host: 10.3.0.2
    port: 80
    points: 100
    environments:
    # TODO: What are we checking for here?
    - matching_content: "background-color:#0072C6;"
      properties:
      - name: useragent
        value: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)
      - name: vhost
        value: 10.3.0.2
      - name: uri
        value: "/"
    - matching_content: "background-color:#0072C6;"
      properties:
      - name: useragent
        value: Opera/9.80 (Windows NT 6.2; Win64; x64) Presto/2.12 Version/12.16
      - name: vhost
        value: 10.3.0.2
      - name: uri
        value: "/"
  - name: HTTPS - Bonaparte
    check_name: HTTPSCheck
    host: 10.3.0.2
    port: 443
    points: 100
    environments:
    - matching_content: "background-color:#0072C6;"
      properties:
      - name: useragent
        value: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)
      - name: vhost
        value: 10.3.0.2
      - name: uri
        value: "/"
    - matching_content: "background-color:#0072C6;"
      properties:
      - name: useragent
        value: Opera/9.80 (Windows NT 6.2; Win64; x64) Presto/2.12 Version/12.16
      - name: vhost
        value: 10.3.0.2
      - name: uri
        value: "/"
  - name: WinRM - Bonaparte
    check_name: winrmCheck
    host: 10.3.0.2
    port: 5985
    points: 150
    accounts:
    - username: martha
      password: "rockyou.txt-SUCKS!"
    - username: jeff
      password: "rockyou.txt-SUCKS!"
    environments:
    - matching_content: "Spaceminersareprettylame"
      properties:
      - name: commands
        value: echo Spaceminersareprettylame
  - name: HTTPS - Ataturk
    check_name: HTTPSCheck
    host: 10.3.0.3
    port: 443
    points: 100
    environments:
    - matching_content: gitlab
      properties:
      - name: useragent
        value: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)
      - name: vhost
        value: 10.3.0.3
      - name: uri
        value: "/"
    - matching_content: gitlab
      properties:
      - name: useragent
        value: Opera/9.80 (Windows NT 6.2; Win64; x64) Presto/2.12 Version/12.16
      - name: vhost
        value: 10.3.0.3
      - name: uri
        value: "/"
  - name: SSH - Ataturk
    check_name: SSHCheck
    host: 10.3.0.3
    port: 22
    points: 150
    accounts:
    - username: jeff
      password: "rockyou.txt-SUCKS!"
    - username: martha
      password: "rockyou.txt-SUCKS!"
    environments:
    - matching_content: "^SUCCESS"
      properties:
      - name: commands
        value: id;ls -l /home
    - matching_content: PID
      properties:
      - name: commands
        value: ps
